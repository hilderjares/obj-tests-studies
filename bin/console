#!/bin/bash

echo -e "\e[1;31m------------------------------------------------\e[0m"
echo -e "\e[1m-------------- Easy Peasy Tool ;) --------------\e[0m"
echo -e "\e[1;31m------------------------------------------------\e[0m"
echo -e "\e[1;33m"
echo -e "\t\t          (__)    "      
echo -e "\t\t          (oo)    "
echo -e "\t\t   /-------\/     "   
echo -e "\t\t  / |     ||      "   
echo -e "\t\t *  ||----||      "  
echo -e "\t\t    ^^    ^^      "
echo -e "\e[1;31m------------------------------------------------\e[0m"

if [ "$1" = "" ];
then 
    echo -e "\e[1myou can use -h to show commands\e[0m"
fi

if [ "$1" = "-h" ];
then 
    echo -e "\e[1myou can type this commands:\e[0m"
    echo -e "\e[38;5;82mtest"
    echo -e "test:dox"
    echo -e "test:coverage"
    echo -e "test:coverage:svg"
    echo -e "docker:restart"
    echo -e "docker:up --flags"
    echo -e "phpcs:check /path"
    echo -e "phpcs:fix /path\e[0m"
fi

if [ "$1" = "docker:up" ];
then
    docker-compose up $2
fi

if [ "$1" = "docker:restart" ];
then 
    docker-compose restart
fi

if [ "$1" = "test" ];
then 
    docker-compose exec --env XDEBUG_MODE=coverage app ./vendor/bin/phpunit $2
fi

if [ "$1" = "test:dox" ];
then 
    docker-compose exec --env XDEBUG_MODE=coverage app ./vendor/bin/phpunit --testdox
fi

if [ "$1" = "test:coverage" ];
then 
    docker-compose exec --env XDEBUG_MODE=coverage app ./vendor/bin/phpunit --coverage-html resources/
fi

if [ "$1" = "test:coverage:svg" ];
then 
    docker-compose exec --env XDEBUG_MODE=coverage app vendor/bin/phpunit --coverage-html resources/ --coverage-clover docs/coverage.xml
    docker-compose exec --env XDEBUG_MODE=coverage app vendor/bin/php-coverage-badger docs/coverage.xml docs/coverage.svg
fi

if [ "$1" = "phpcs:check" ];
then 
    docker-compose exec app ./vendor/bin/php-cs-fixer fix --diff --verbose --dry-run $2
fi

if [ "$1" = "phpcs:fix" ];
then 
    docker-compose exec app ./vendor/bin/php-cs-fixer fix $2
fi